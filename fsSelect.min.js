!function(a){var b={init:function(a){return this.each(function(){b.iniElements(this),b.addEvents(this)})},iniElements:function(d){this.$select=a(d);var e=a("<div></div>").addClass("input-group fs-search"),f=a("<input>").attr("type","text").attr("placeholder",c.placeholder).addClass("form-control"),g=a("<button></button>").attr("type","button").attr("data-toggle","dropdown").attr("aria-haspopup","true").attr("aria-expanded","false").addClass("btn btn-default").append('<span class="glyphicon glyphicon-plus"></span>'),h=a("<li></li>").addClass("fs-selectAll").text("Select All"),i=a("<li></li>").addClass("fs-deSelectAll").text("DeSelect All"),j=a("<li></li>").addClass("fs-showSelected").text("Show Selected"),k=a("<ul></ul>").addClass("dropdown-menu dropdown-menu-right").append(h,i,j),l=a("<button></button>").addClass("fs-resourceMenuButton").addClass("btn btn-default").append('<span class="caret"></span>'),m=a("<div></div>").addClass("input-group-btn").append(g,k,l),n=e.append(f,m);this.$select.wrap("<div class=fs-wrap/>"),this.$select.addClass("hidden"),this.$wrap=this.$select.parent(".fs-wrap"),this.$wrap.prepend(n),this.$select.before('<div class="fs-dropdown hidden"></div>'),b.buildOptions(a(".fs-dropdown"))},buildOptions:function(d){for(var e=0;e<c.optionNum;e++){var f=c.optionValues[e],g=b.shortenOptionText(f),h=a("<div></div>").addClass("fs-option").attr("value",f).attr("data-index",e),i=a("<div></div>").addClass("fs-option-label").append("<input type=checkbox />").append("<span></span>").find("span").addClass("fs-url").text(g).end();h.append(i),d.append(h)}},addEvents:function(){a(".input-group.fs-search").on("click",b.clickOnSearch),a(".fs-option").on("click",b.clickOnOption),a(".fs-option-label input").on("click",b.chosenOption),a(".fs-search input").on("keyup",b.optionSearch),a(document).on("click","*",b.checkCloseDropdown),a(".fs-resourceMenuButton").on("click",b.clickOnResourceMenuButton),a(".fs-selectAll").on("click",b.selectAllResource),a(".fs-deSelectAll").on("click",b.deSelectAllResource),a(".fs-showSelected").on("click",b.showSelectedResource)},clickOnOption:function(b){if("checkbox"!=a(b.target).attr("type")){var e=a(b.target).closest(".fs-option");e.hasClass("clicked")?(e.removeClass("clicked"),c.selectedOptionIndex=-1):(c.selectedOptionIndex!=-1&&a(a(".fs-option")[c.selectedOptionIndex]).removeClass("clicked"),e.addClass("clicked"),c.selectedOptionIndex=parseInt(e.attr("data-index"))),d.optionClicked(this)}},clickOnSearch:function(c){a(c.target).hasClass("resourceMenuButton")||b.openDropdown()},clickOnResourceMenuButton:function(){var c=a(".fs-dropdown");c.hasClass("hidden")?b.openDropdown():(console.log("test"),b.closeDropdown()),this.blur()},chosenOption:function(c){var d=a(c.target).closest(".fs-option");d.hasClass("selected")?d.removeClass("selected"):d.addClass("selected"),b.updateChosenOption()},optionSearch:function(){var b=a(".fs-wrap"),c=/[|\\{}()[\]^$+*?.]/g,d=a(this).val().replace(c,"\\$&");b.find(".fs-option").removeClass("hidden"),""!=d&&b.find(".fs-option").each(function(){var b=new RegExp(d,"gi");null===a(this).attr("value").match(b)&&a(this).addClass("hidden")})},checkCloseDropdown:function(c){var d=a(c.target).closest(".fs-wrap");d.hasClass("fs-wrap")||b.closeDropdown()},shortenOptionText:function(a){var b=a.length;return b>50?a.slice(0,20)+"..."+a.slice(b-20,b):a},openDropdown:function(b){a(".fs-dropdown").removeClass("hidden")},closeDropdown:function(b){a(".fs-dropdown").addClass("hidden")},selectAllResource:function(){a(".fs-option:not(.hidden)").addClass("selected"),a(".fs-option:not(.hidden)").each(function(){a(this).find("input").get(0).checked=!0,c.chosenOptionIndexes.push(parseInt(a(this).closest(".fs-option").attr("data-index")))}),b.updateChosenOption(),d.optionClicked(this)},deSelectAllResource:function(){a(".fs-option.selected:not(.hidden)").each(function(){a(this).find("input").get(0).checked=!1}),a(".fs-option:not(.hidden)").removeClass("selected"),b.updateChosenOption(),d.optionClicked(this)},showSelectedResource:function(){a(this).hasClass("clicked")?(a(".fs-option").removeClass("hidden"),a(".fs-showSelected").removeClass("clicked")):(a(".fs-option:not(.selected)").addClass("hidden"),a(".fs-showSelected").addClass("clicked")),d.optionClicked(this)},updateChosenOption:function(){c.chosenOptionIndexes=[],a(".fs-option.selected").each(function(){c.chosenOptionIndexes.push(parseInt(a(this).attr("data-index")))})},clickOnOptionBind:function(b){var c=function(c){"checkbox"!=a(c.target).attr("type")&&b()};return a(".fs-option").on("click",c),this},chooseOptionBind:function(b){return a(".fs-option-label input").on("click",b),this},mouseOverOptionBind:function(b){return a(".fs-option").on("mouseover",b),this},mouseOutOptionBind:function(b){return a(".fs-option").on("mouseout",b),this},selectAllBind:function(b){return a(".fs-selectAll").on("click",b),this},deSelectAllBind:function(b){return a(".fs-deSelectAll").on("click",b),this},showSelectedBind:function(b){return a(".fs-showSelected").on("click",b),this},getOptionNum:function(){return c.optionNum},getSelectedOptionIndex:function(){return c.selectedOptionIndex},getChosenOptionIndexes:function(){return c.chosenOptionIndexes},getMouseIndex:function(){return a(document).mousemove(function(b){c.mouseoverIndex=a(b.target).closest(".fs-option").attr("data-index")}),c.mouseoverIndex||-1},setChosenOptionIndexes:function(b){c.chosenOptionIndexes=b,a(".fs-option").each(function(){var b=parseInt(a(this).attr("data-index"));c.chosenOptionIndexes.findIndex(function(a){return a===b})!=-1?a(this).find("input").get(0).checked=!0:a(this).find("input").get(0).checked=!1})},setSelectedOptionIndex:function(b){return a(a(".fs-option")[c.selectedOptionIndex]).removeClass("clicked"),c.selectedOptionIndex=b,c.selectedOptionIndex!=-1&&a(".fs-option")[c.selectedOptionIndex].addClass("clicked"),d.optionClicked(a(".fs-dropdown")),d.optionClicked(a(".dropdown-menu")),c.selectedOptionIndex}},c={optionNum:0,optionValues:[],placeholder:"",mouseoverIndex:-1,selectedOptionIndex:-1,chosenOptionIndexes:[]},d={optionClicked:function(b){$element=a(b);var c=$element.closest("*[class*='dropdown']");c.children().css("background-color","#fff"),c.children(".clicked").css("background-color","#e1e1ea")}};a.fn.fsSelect=function(d){var e={placeholder:"Resource filter",data:[]},f=a.extend({},e,d);return c.optionNum=f.data.length,c.optionValues=f.data,c.placeholder=f.placeholder,b[d]?b[d].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof d&&d?void a.error("Method "+d+" does not exist on jQuery.fsSelect"):b.init.apply(this,arguments)}}(jQuery);
